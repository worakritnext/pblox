import{_ as t}from"../../chunks/preload-helper-08cc8e69.js";import{S as e,i as s,s as n,e as o,t as a,k as r,c as i,a as c,g as u,d as l,n as d,b as h,f,D as p,F as m,G as v,Q as g,h as y,H as x,A as b}from"../../chunks/vendor-ec965bd2.js";import{g as k}from"../../chunks/navigation-2ffed81e.js";import{u as w}from"../../chunks/user-96e9540c.js";import"../../chunks/singletons-12a22614.js";function E(t){let e,s,n,y,x,b,k,w;return{c(){e=o("p"),s=o("button"),n=a("อัพเดท"),y=r(),x=o("button"),b=a("ลบ"),this.h()},l(t){e=i(t,"P",{class:!0});var o=c(e);s=i(o,"BUTTON",{class:!0});var a=c(s);n=u(a,"อัพเดท"),a.forEach(l),y=d(o),x=i(o,"BUTTON",{class:!0});var r=c(x);b=u(r,"ลบ"),r.forEach(l),o.forEach(l),this.h()},h(){h(s,"class","bg-blue-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(x,"class","bg-red-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(e,"class","my-2 flex justify-center items-center gap-3")},m(o,a){f(o,e,a),p(e,s),p(s,n),p(e,y),p(e,x),p(x,b),k||(w=[m(s,"click",t[4]),m(x,"click",t[3])],k=!0)},p:v,d(t){t&&l(e),k=!1,g(w)}}}function j(t){let e,s,n,m,g,x,b,k,w,j=t[0].title+"",T=(t[0].author.username||"ผู้เขียนไร้นาม")+"",_=t[2]&&t[0].author.id===t[2].id&&E(t);return{c(){e=o("h1"),s=a(j),n=r(),m=o("p"),g=a("By: "),x=a(T),b=r(),_&&_.c(),k=r(),w=o("div"),this.h()},l(t){e=i(t,"H1",{class:!0});var o=c(e);s=u(o,j),o.forEach(l),n=d(t),m=i(t,"P",{class:!0});var a=c(m);g=u(a,"By: "),x=u(a,T),a.forEach(l),b=d(t),_&&_.l(t),k=d(t),w=i(t,"DIV",{class:!0}),c(w).forEach(l),this.h()},h(){h(e,"class","text-center text-4xl mt-4"),h(m,"class","text-center mt-2"),h(w,"class","border border-gray-500 my-4 mx-8 p-6 rounded")},m(o,a){f(o,e,a),p(e,s),f(o,n,a),f(o,m,a),p(m,g),p(m,x),f(o,b,a),_&&_.m(o,a),f(o,k,a),f(o,w,a),w.innerHTML=t[1]},p(t,[e]){1&e&&j!==(j=t[0].title+"")&&y(s,j),1&e&&T!==(T=(t[0].author.username||"ผู้เขียนไร้นาม")+"")&&y(x,T),t[2]&&t[0].author.id===t[2].id?_?_.p(t,e):(_=E(t),_.c(),_.m(k.parentNode,k)):_&&(_.d(1),_=null),2&e&&(w.innerHTML=t[1])},i:v,o:v,d(t){t&&l(e),t&&l(n),t&&l(m),t&&l(b),_&&_.d(t),t&&l(k),t&&l(w)}}}var T=function(t,e,s,n){return new(s||(s=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,i)}c((n=n.apply(t,e||[])).next())}))};const _=({page:{params:t},fetch:e})=>T(void 0,void 0,void 0,(function*(){const{slug:s}=t,n=yield e("http://localhost:1337/posts/"+s);if(404===n.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}return{props:{post:yield n.json()}}}));function B(e,s,n){let o;x(e,w,(t=>n(2,o=t)));var a=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,i)}c((n=n.apply(t,e||[])).next())}))};let{post:r}=s,i=r.content;b((()=>a(void 0,void 0,void 0,(function*(){const e=(yield t((()=>import("../../chunks/marked-ffb29f0c.js").then((function(t){return t.m}))),[])).default;n(1,i=e(r.content))}))));return e.$$set=t=>{"post"in t&&n(0,r=t.post)},[r,i,o,function(){var t,e,s,n;return a(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void k("/login");const o=yield fetch("http://localhost:1337/posts/"+r.id,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token")}});if(o.ok)k("/");else{const a=yield o.json();(null===(n=null===(s=null===(e=null===(t=null==a?void 0:a.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===n?void 0:n.message)&&alert(a.message[0].messages[0].message)}}))},()=>k("/new?edit="+r.id)]}class D extends e{constructor(t){super(),s(this,t,B,j,n,{post:0})}}export{D as default,_ as load};
